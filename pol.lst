00000000                            ;
00000000                            ; POL.s ... follow Chuck's travel.
00000000                            ;
00000000                            ;
00000000                            ; definitions
00000000                            ram         equ 0
00000000                            start       equ $80
00000000                            uart_dreg   equ $1f00
00000000                            uart_creg   equ $1f01
00000000                            u3txif      equ 2
00000000                            u3rxif      equ 1
00000000                            
00000000                            
00000000                                org     ram
00000000 0000 0000                      dc.l    main
00000004 0000 1FFF                      dc.l    $1fff
00000008                                org     start
00000080                            main:
00000080 1239 0000 0061                 move.b   "a",d1
00000086                            loop:
00000086 3001                           move.w  d1,d0
00000088 C039 0000 001F                 and.b     $1f,d0
0000008E D039 0000 0040                 add.b     $40,d0
00000094 4EB9 0000 0000                 jsr     (putch)
0000009A D239 0000 0001                 add.b   1,d1
000000A0 60E4                           bra.b   loop
000000A2                            ;
000000A2                            ; put one char in d0
000000A2                            ;
000000A2                            putch:
000000A2 3F00                           move.w    d0,-(a7)          ; push d0
000000A4                            putch1:
000000A4 1039 0000 1F01                 move.b  (uart_creg),d0
000000AA C039 0000 0002                 and.b   u3txif,d0
000000B0 67F2                           beq.b    putch1
000000B2                                ; now TXBUF be ready
000000B2 301F                           move.w     (a7)+,d0         ; pop d0
000000B4 13C0 0000 1F00                 move.b  d0,(uart_dreg)
000000BA 4E75                           rts
000000BC                            
000000BC                                end
